/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */
package vista;

import controlador.Biblioteca;
import java.awt.event.KeyEvent;
import javax.swing.JOptionPane;

/**
 *
 * @author USUARIO
 */
public class Alta extends javax.swing.JPanel {
    
    Biblioteca miBiblio;
    
    public Alta(Biblioteca miBiblio) {
        initComponents();
        this.miBiblio = miBiblio;
    }

    /**
     * This method is called from within the constructor to initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is always
     * regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {

        jLabel1 = new javax.swing.JLabel();
        lblNombre = new javax.swing.JLabel();
        lblApellidos = new javax.swing.JLabel();
        txtNombre = new javax.swing.JTextField();
        txtApellidos = new javax.swing.JTextField();
        btnCancelar = new javax.swing.JButton();
        btnGuardar = new javax.swing.JButton();
        lblLogin = new javax.swing.JLabel();
        lblPass = new javax.swing.JLabel();
        txtLogin = new javax.swing.JTextField();
        txtPass = new javax.swing.JPasswordField();

        jLabel1.setFont(new java.awt.Font("Arial", 1, 36)); // NOI18N
        jLabel1.setHorizontalAlignment(javax.swing.SwingConstants.CENTER);
        jLabel1.setText("ALTA DE USUARIOS");

        lblNombre.setText("Nombre");

        lblApellidos.setText("Apellidos");

        txtNombre.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                txtNombreKeyPressed(evt);
            }
        });

        txtApellidos.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                txtApellidosActionPerformed(evt);
            }
        });
        txtApellidos.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                txtApellidosKeyPressed(evt);
            }
        });

        btnCancelar.setText("Cancelar");
        btnCancelar.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                btnCancelarMouseClicked(evt);
            }
        });

        btnGuardar.setText("Guardar");
        btnGuardar.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                btnGuardarMouseClicked(evt);
            }
        });

        lblLogin.setText("Login");

        lblPass.setText("Password");

        txtLogin.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                txtLoginActionPerformed(evt);
            }
        });
        txtLogin.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                txtLoginKeyPressed(evt);
            }
        });

        txtPass.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                txtPassKeyPressed(evt);
            }
        });

        javax.swing.GroupLayout layout = new javax.swing.GroupLayout(this);
        this.setLayout(layout);
        layout.setHorizontalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(layout.createSequentialGroup()
                .addGap(158, 158, 158)
                .addComponent(btnCancelar)
                .addGap(209, 209, 209)
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(txtNombre, javax.swing.GroupLayout.PREFERRED_SIZE, 227, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(btnGuardar)
                    .addComponent(txtApellidos, javax.swing.GroupLayout.PREFERRED_SIZE, 227, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(txtLogin, javax.swing.GroupLayout.PREFERRED_SIZE, 227, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addContainerGap(125, Short.MAX_VALUE))
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, layout.createSequentialGroup()
                .addGap(140, 140, 140)
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(layout.createSequentialGroup()
                        .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addComponent(lblApellidos)
                            .addComponent(lblLogin)
                            .addComponent(lblNombre))
                        .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                    .addGroup(layout.createSequentialGroup()
                        .addComponent(lblPass)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                        .addComponent(txtPass, javax.swing.GroupLayout.PREFERRED_SIZE, 227, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addGap(121, 121, 121))))
        );
        layout.setVerticalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(layout.createSequentialGroup()
                .addGap(144, 144, 144)
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(lblNombre)
                    .addComponent(txtNombre, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(43, 43, 43)
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(lblApellidos)
                    .addComponent(txtApellidos, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(59, 59, 59)
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(lblLogin)
                    .addComponent(txtLogin, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(62, 62, 62)
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(txtPass, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(lblPass))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, 93, Short.MAX_VALUE)
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(btnCancelar)
                    .addComponent(btnGuardar))
                .addGap(73, 73, 73))
        );
    }// </editor-fold>//GEN-END:initComponents

    private void txtApellidosActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_txtApellidosActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_txtApellidosActionPerformed

    private void txtLoginActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_txtLoginActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_txtLoginActionPerformed

    private void txtNombreKeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_txtNombreKeyPressed
        // TODO add your handling code here:

        switch (evt.getKeyCode()) {
            case KeyEvent.VK_F1:
                // el usuario ha presionado la tecla F1, por lo que debe
                // mostrar que información hay que introducir en ese campo.
                JOptionPane.showMessageDialog(this, "Nombre del usuario",
                        "Información del campo", JOptionPane.INFORMATION_MESSAGE);
                break;
            case KeyEvent.VK_ENTER:
                // el usuario ha presionado la tecla enter
                txtApellidos.requestFocus();// coloca el cursor en el siguiente campo
                break;
            case KeyEvent.VK_ESCAPE:
                // el usuario ha presionado escape
                txtNombre.setText(""); // borrar lo que hay en ese campo.

        }

    }//GEN-LAST:event_txtNombreKeyPressed

    private void txtApellidosKeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_txtApellidosKeyPressed
        // TODO add your handling code here:

        switch (evt.getKeyCode()) {
            case KeyEvent.VK_F1:
                JOptionPane.showMessageDialog(this, "Apellidos del usuario",
                        "Informacion del campo", JOptionPane.INFORMATION_MESSAGE);
                break;
            case KeyEvent.VK_ENTER:
                
                txtLogin.requestFocus();
                break;
            
            case KeyEvent.VK_ESCAPE:
                
                txtApellidos.setToolTipText("");
            
        }

    }//GEN-LAST:event_txtApellidosKeyPressed

    private void txtLoginKeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_txtLoginKeyPressed
        // TODO add your handling code here:

        switch (evt.getKeyCode()) {
            
            case KeyEvent.VK_F1:
                
                JOptionPane.showMessageDialog(this, "Login del usuario",
                        "Informacion del campo", JOptionPane.INFORMATION_MESSAGE);
            
            case KeyEvent.VK_ENTER:
                
                txtPass.requestFocus();
            
            case KeyEvent.VK_ESCAPE:
                txtLogin.setToolTipText("");
            
        }
        

    }//GEN-LAST:event_txtLoginKeyPressed

    private void txtPassKeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_txtPassKeyPressed
        // TODO add your handling code here:

        switch (evt.getKeyCode()) {
            
            case KeyEvent.VK_F1:
                
                JOptionPane.showMessageDialog(this, "Informacion del campo",
                        "Password del usuario", JOptionPane.INFORMATION_MESSAGE);
            case KeyEvent.VK_ESCAPE:
                
                txtPass.setText("");
            
        }
        

    }//GEN-LAST:event_txtPassKeyPressed

    private void btnCancelarMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_btnCancelarMouseClicked
        // TODO add your handling code here:
        
        limpiar();
    }//GEN-LAST:event_btnCancelarMouseClicked

    private void btnGuardarMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_btnGuardarMouseClicked
        // TODO add your handling code here:
        
        boolean comprobar;
        
        String nombre, apellido, login, pass;
        nombre = txtNombre.getText().trim();
        
        if (validarCampo(nombre)) {
            
            JOptionPane.showMessageDialog(this, " Campo Requerido",
                    " Información", JOptionPane.ERROR_MESSAGE);
            txtNombre.requestFocus();;
            
        } else {
            
            apellido = txtApellidos.getText().trim();
            
            if (validarCampo(apellido)) {//comprueba si el campo esta vacio
                
                JOptionPane.showMessageDialog(this, "Campo Requerido",
                        "Inormacion", JOptionPane.ERROR_MESSAGE);
                
                txtApellidos.requestFocus();
                
            } else {
                
                login = txtLogin.getText().trim();
                
                if (validarCampo(login)) {
                    
                    JOptionPane.showMessageDialog(this, "Campo requerido",
                            "Informacion", JOptionPane.ERROR_MESSAGE);
                    
                    txtLogin.setText("");
                    
                    
                }else{
                
                    pass= new String(txtPass.getPassword());
                    
                    if(validarCampo(pass)){
                        
                        JOptionPane.showMessageDialog(this, "Campo Requerido",
                                "Informacion",JOptionPane.ERROR_MESSAGE);
                        txtPass.requestFocus();
                    
                    
                    }else{
                    
                    int resultado= miBiblio.nuevoUsuario(nombre, apellido, login, pass);
                    
                    if(resultado ==-1){
                        // si no estan ocupados esos campos saltara esta info diciendo que se ha guardado correctamente
                        JOptionPane.showMessageDialog(this, "Usuario Añadido",
                                "Alta Usuarios",JOptionPane.INFORMATION_MESSAGE);
                        //Una vez guardados los datos borramos el texto que hay en los campos
                        limpiar();
                        
                    }else{
                    //Salata este mensaje si el usuario ya esta creado
                    JOptionPane.showMessageDialog(this,"Usuario Existente","Error",JOptionPane.ERROR_MESSAGE);
                    //por lo tanto borramos todo lo que contienen las cajas de texto 
                    limpiar();
                    //y mandamos al foco al principio del formulario para ingresar otra vez
                    txtNombre.requestFocus();
                    
                    }
                    
                    
                    }
                
                }
                
            }
            
        }
        

    }//GEN-LAST:event_btnGuardarMouseClicked
    
    public void limpiar() {
        
        txtNombre.setText("");
        txtApellidos.setText("");
        txtLogin.setText("");
        txtPass.setText("");        
        
    }
    
    private boolean validarCampo(String valor) {
        boolean resultado = false;
        if (valor.equals("")) {
            resultado = true;
        }
        return resultado;
    }

    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JButton btnCancelar;
    private javax.swing.JButton btnGuardar;
    private javax.swing.JLabel jLabel1;
    private javax.swing.JLabel lblApellidos;
    private javax.swing.JLabel lblLogin;
    private javax.swing.JLabel lblNombre;
    private javax.swing.JLabel lblPass;
    private javax.swing.JTextField txtApellidos;
    private javax.swing.JTextField txtLogin;
    private javax.swing.JTextField txtNombre;
    private javax.swing.JPasswordField txtPass;
    // End of variables declaration//GEN-END:variables
}
